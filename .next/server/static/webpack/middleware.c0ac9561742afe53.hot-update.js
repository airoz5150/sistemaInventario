"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
self["webpackHotUpdate_N_E"]("middleware",{

/***/ "(middleware)/./middleware.js":
/*!***********************!*\
  !*** ./middleware.js ***!
  \***********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   middleware: () => (/* binding */ middleware)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(middleware)/./node_modules/next/dist/esm/api/server.js\");\n/* harmony import */ var jose__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! jose */ \"(middleware)/./node_modules/jose/dist/browser/index.js\");\n\n\nasync function middleware(request) {\n    const jwt = request.cookies.get(\"token\");\n    const isLoginPage = request.nextUrl.pathname === \"/login\";\n    const protectedRoutes = [\n        \"/Equipments\",\n        \"/Employees\",\n        \"/Reports\",\n        \"/users\",\n        \"/Home\",\n        \"/Activities\",\n        \"/Peripherals\",\n        \"/unauthorized\"\n    ];\n    const protectedRoutesUser = [\n        \"/Reports\",\n        \"/Home\",\n        \"/AsignedActivities\",\n        \"/unauthorized\"\n    ];\n    if (!jwt) {\n        if (!isLoginPage) {\n            // If there is no JWT and the user is not on the login page, redirect to login\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.redirect(new URL(\"/\", request.url));\n        }\n    } else {\n        if (isLoginPage) {\n            // If the user is already logged in, redirect them to the home page\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.redirect(new URL(\"/Home\", request.url));\n        }\n        try {\n            const { payload } = await (0,jose__WEBPACK_IMPORTED_MODULE_1__.jwtVerify)(jwt.value, new TextEncoder().encode(\"secret\"));\n            const userRole = payload.role;\n            // Protect routes based on the user role\n            switch(userRole){\n                case \"admin\":\n                    // Admin should not access routes meant for regular users\n                    if (!protectedRoutes.includes(request.nextUrl.pathname)) {\n                        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.redirect(new URL(\"/unauthorized\", request.url));\n                    }\n                    break;\n                case \"user\":\n                    // User should not access routes meant for admins\n                    if (!protectedRoutesUser.includes(request.nextUrl.pathname)) {\n                        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.redirect(new URL(\"/unauthorized\", request.url));\n                    }\n                    break;\n                default:\n                    // Default case if the role is unknown or unauthorized\n                    return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.redirect(new URL(\"/unauthorized\", request.url));\n            }\n        } catch (error) {\n            // If there's an error verifying the JWT, redirect to the login page\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.redirect(new URL(\"/\", request.url));\n        }\n    }\n    // Allow the request to proceed to the next middleware or route handler\n    return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.next();\n}\nconst config = {\n    matcher: [\n        \"/Home\",\n        \"/Equipments\",\n        \"/Employees\",\n        \"/login\",\n        \"/Reports\",\n        \"/unauthorized\",\n        \"/users\",\n        \"/AsignedActivities\",\n        \"/Peripherals\",\n        \"/Activities\"\n    ]\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKG1pZGRsZXdhcmUpLy4vbWlkZGxld2FyZS5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7O0FBQTJDO0FBQ1Y7QUFFMUIsZUFBZUUsV0FBV0MsT0FBTztJQUN0QyxNQUFNQyxNQUFNRCxRQUFRRSxPQUFPLENBQUNDLEdBQUcsQ0FBQztJQUVoQyxNQUFNQyxjQUFjSixRQUFRSyxPQUFPLENBQUNDLFFBQVEsS0FBSztJQUNqRCxNQUFNQyxrQkFBa0I7UUFBQztRQUFlO1FBQWM7UUFBWTtRQUFVO1FBQVM7UUFBZTtRQUFlO0tBQWdCO0lBQ25JLE1BQU1DLHNCQUFzQjtRQUFDO1FBQVk7UUFBUztRQUFxQjtLQUFnQjtJQUV2RixJQUFJLENBQUNQLEtBQUs7UUFDUixJQUFJLENBQUNHLGFBQWE7WUFDaEIsOEVBQThFO1lBQzlFLE9BQU9QLHFEQUFZQSxDQUFDWSxRQUFRLENBQUMsSUFBSUMsSUFBSSxLQUFLVixRQUFRVyxHQUFHO1FBQ3ZEO0lBQ0YsT0FBTztRQUNMLElBQUlQLGFBQWE7WUFDZixtRUFBbUU7WUFDbkUsT0FBT1AscURBQVlBLENBQUNZLFFBQVEsQ0FBQyxJQUFJQyxJQUFJLFNBQVNWLFFBQVFXLEdBQUc7UUFDM0Q7UUFFQSxJQUFJO1lBQ0YsTUFBTSxFQUFFQyxPQUFPLEVBQUUsR0FBRyxNQUFNZCwrQ0FBU0EsQ0FBQ0csSUFBSVksS0FBSyxFQUFFLElBQUlDLGNBQWNDLE1BQU0sQ0FBQztZQUN4RSxNQUFNQyxXQUFXSixRQUFRSyxJQUFJO1lBRTdCLHdDQUF3QztZQUN4QyxPQUFRRDtnQkFDTixLQUFLO29CQUNILHlEQUF5RDtvQkFDekQsSUFBSSxDQUFDVCxnQkFBZ0JXLFFBQVEsQ0FBQ2xCLFFBQVFLLE9BQU8sQ0FBQ0MsUUFBUSxHQUFHO3dCQUN2RCxPQUFPVCxxREFBWUEsQ0FBQ1ksUUFBUSxDQUFDLElBQUlDLElBQUksaUJBQWlCVixRQUFRVyxHQUFHO29CQUNuRTtvQkFDQTtnQkFFRixLQUFLO29CQUNILGlEQUFpRDtvQkFDakQsSUFBSSxDQUFDSCxvQkFBb0JVLFFBQVEsQ0FBQ2xCLFFBQVFLLE9BQU8sQ0FBQ0MsUUFBUSxHQUFHO3dCQUMzRCxPQUFPVCxxREFBWUEsQ0FBQ1ksUUFBUSxDQUFDLElBQUlDLElBQUksaUJBQWlCVixRQUFRVyxHQUFHO29CQUNuRTtvQkFDQTtnQkFFRjtvQkFDRSxzREFBc0Q7b0JBQ3RELE9BQU9kLHFEQUFZQSxDQUFDWSxRQUFRLENBQUMsSUFBSUMsSUFBSSxpQkFBaUJWLFFBQVFXLEdBQUc7WUFDckU7UUFFRixFQUFFLE9BQU9RLE9BQU87WUFDZCxvRUFBb0U7WUFDcEUsT0FBT3RCLHFEQUFZQSxDQUFDWSxRQUFRLENBQUMsSUFBSUMsSUFBSSxLQUFLVixRQUFRVyxHQUFHO1FBQ3ZEO0lBQ0Y7SUFFQSx1RUFBdUU7SUFDdkUsT0FBT2QscURBQVlBLENBQUN1QixJQUFJO0FBQzFCO0FBRU8sTUFBTUMsU0FBUztJQUNwQkMsU0FBUztRQUFDO1FBQVE7UUFBZTtRQUFjO1FBQVU7UUFBWTtRQUFpQjtRQUFVO1FBQXNCO1FBQWdCO0tBQWM7QUFDdEosRUFBRSIsInNvdXJjZXMiOlsid2VicGFjazovLy8uL21pZGRsZXdhcmUuanM/M2JjYiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBOZXh0UmVzcG9uc2UgfSBmcm9tIFwibmV4dC9zZXJ2ZXJcIjtcclxuaW1wb3J0IHsgand0VmVyaWZ5IH0gZnJvbSBcImpvc2VcIjtcclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBtaWRkbGV3YXJlKHJlcXVlc3QpIHtcclxuICBjb25zdCBqd3QgPSByZXF1ZXN0LmNvb2tpZXMuZ2V0KFwidG9rZW5cIik7XHJcblxyXG4gIGNvbnN0IGlzTG9naW5QYWdlID0gcmVxdWVzdC5uZXh0VXJsLnBhdGhuYW1lID09PSBcIi9sb2dpblwiO1xyXG4gIGNvbnN0IHByb3RlY3RlZFJvdXRlcyA9IFtcIi9FcXVpcG1lbnRzXCIsIFwiL0VtcGxveWVlc1wiLCBcIi9SZXBvcnRzXCIsIFwiL3VzZXJzXCIsIFwiL0hvbWVcIiwgXCIvQWN0aXZpdGllc1wiLCBcIi9QZXJpcGhlcmFsc1wiLFwiL3VuYXV0aG9yaXplZFwiXTtcclxuICBjb25zdCBwcm90ZWN0ZWRSb3V0ZXNVc2VyID0gW1wiL1JlcG9ydHNcIiwgXCIvSG9tZVwiLCBcIi9Bc2lnbmVkQWN0aXZpdGllc1wiLFwiL3VuYXV0aG9yaXplZFwiXTtcclxuXHJcbiAgaWYgKCFqd3QpIHtcclxuICAgIGlmICghaXNMb2dpblBhZ2UpIHtcclxuICAgICAgLy8gSWYgdGhlcmUgaXMgbm8gSldUIGFuZCB0aGUgdXNlciBpcyBub3Qgb24gdGhlIGxvZ2luIHBhZ2UsIHJlZGlyZWN0IHRvIGxvZ2luXHJcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UucmVkaXJlY3QobmV3IFVSTChcIi9cIiwgcmVxdWVzdC51cmwpKTtcclxuICAgIH1cclxuICB9IGVsc2Uge1xyXG4gICAgaWYgKGlzTG9naW5QYWdlKSB7XHJcbiAgICAgIC8vIElmIHRoZSB1c2VyIGlzIGFscmVhZHkgbG9nZ2VkIGluLCByZWRpcmVjdCB0aGVtIHRvIHRoZSBob21lIHBhZ2VcclxuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5yZWRpcmVjdChuZXcgVVJMKFwiL0hvbWVcIiwgcmVxdWVzdC51cmwpKTtcclxuICAgIH1cclxuXHJcbiAgICB0cnkge1xyXG4gICAgICBjb25zdCB7IHBheWxvYWQgfSA9IGF3YWl0IGp3dFZlcmlmeShqd3QudmFsdWUsIG5ldyBUZXh0RW5jb2RlcigpLmVuY29kZShcInNlY3JldFwiKSk7XHJcbiAgICAgIGNvbnN0IHVzZXJSb2xlID0gcGF5bG9hZC5yb2xlO1xyXG5cclxuICAgICAgLy8gUHJvdGVjdCByb3V0ZXMgYmFzZWQgb24gdGhlIHVzZXIgcm9sZVxyXG4gICAgICBzd2l0Y2ggKHVzZXJSb2xlKSB7XHJcbiAgICAgICAgY2FzZSBcImFkbWluXCI6XHJcbiAgICAgICAgICAvLyBBZG1pbiBzaG91bGQgbm90IGFjY2VzcyByb3V0ZXMgbWVhbnQgZm9yIHJlZ3VsYXIgdXNlcnNcclxuICAgICAgICAgIGlmICghcHJvdGVjdGVkUm91dGVzLmluY2x1ZGVzKHJlcXVlc3QubmV4dFVybC5wYXRobmFtZSkpIHtcclxuICAgICAgICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5yZWRpcmVjdChuZXcgVVJMKFwiL3VuYXV0aG9yaXplZFwiLCByZXF1ZXN0LnVybCkpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgYnJlYWs7XHJcblxyXG4gICAgICAgIGNhc2UgXCJ1c2VyXCI6XHJcbiAgICAgICAgICAvLyBVc2VyIHNob3VsZCBub3QgYWNjZXNzIHJvdXRlcyBtZWFudCBmb3IgYWRtaW5zXHJcbiAgICAgICAgICBpZiAoIXByb3RlY3RlZFJvdXRlc1VzZXIuaW5jbHVkZXMocmVxdWVzdC5uZXh0VXJsLnBhdGhuYW1lKSkge1xyXG4gICAgICAgICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLnJlZGlyZWN0KG5ldyBVUkwoXCIvdW5hdXRob3JpemVkXCIsIHJlcXVlc3QudXJsKSk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICBicmVhaztcclxuXHJcbiAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgIC8vIERlZmF1bHQgY2FzZSBpZiB0aGUgcm9sZSBpcyB1bmtub3duIG9yIHVuYXV0aG9yaXplZFxyXG4gICAgICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5yZWRpcmVjdChuZXcgVVJMKFwiL3VuYXV0aG9yaXplZFwiLCByZXF1ZXN0LnVybCkpO1xyXG4gICAgICB9XHJcblxyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgLy8gSWYgdGhlcmUncyBhbiBlcnJvciB2ZXJpZnlpbmcgdGhlIEpXVCwgcmVkaXJlY3QgdG8gdGhlIGxvZ2luIHBhZ2VcclxuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5yZWRpcmVjdChuZXcgVVJMKFwiL1wiLCByZXF1ZXN0LnVybCkpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLy8gQWxsb3cgdGhlIHJlcXVlc3QgdG8gcHJvY2VlZCB0byB0aGUgbmV4dCBtaWRkbGV3YXJlIG9yIHJvdXRlIGhhbmRsZXJcclxuICByZXR1cm4gTmV4dFJlc3BvbnNlLm5leHQoKTtcclxufVxyXG5cclxuZXhwb3J0IGNvbnN0IGNvbmZpZyA9IHtcclxuICBtYXRjaGVyOiBbXCIvSG9tZVwiLFwiL0VxdWlwbWVudHNcIiwgXCIvRW1wbG95ZWVzXCIsIFwiL2xvZ2luXCIsIFwiL1JlcG9ydHNcIiwgXCIvdW5hdXRob3JpemVkXCIsIFwiL3VzZXJzXCIsIFwiL0FzaWduZWRBY3Rpdml0aWVzXCIsIFwiL1BlcmlwaGVyYWxzXCIsIFwiL0FjdGl2aXRpZXNcIl0sXHJcbn07XHJcbiJdLCJuYW1lcyI6WyJOZXh0UmVzcG9uc2UiLCJqd3RWZXJpZnkiLCJtaWRkbGV3YXJlIiwicmVxdWVzdCIsImp3dCIsImNvb2tpZXMiLCJnZXQiLCJpc0xvZ2luUGFnZSIsIm5leHRVcmwiLCJwYXRobmFtZSIsInByb3RlY3RlZFJvdXRlcyIsInByb3RlY3RlZFJvdXRlc1VzZXIiLCJyZWRpcmVjdCIsIlVSTCIsInVybCIsInBheWxvYWQiLCJ2YWx1ZSIsIlRleHRFbmNvZGVyIiwiZW5jb2RlIiwidXNlclJvbGUiLCJyb2xlIiwiaW5jbHVkZXMiLCJlcnJvciIsIm5leHQiLCJjb25maWciLCJtYXRjaGVyIl0sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(middleware)/./middleware.js\n");

/***/ })

});